<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sea to Summit</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Silkscreen&display=swap" rel="stylesheet">

<style>
html, body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:black;
  overflow:hidden;
  font-family: 'Silkscreen', monospace;
}

#stage{
  position:absolute;
  left:50%;
  top:50%;
  width:1920px;
  height:1080px;
  transform:translate(-50%, -50%);
  transform-origin: top left;
}

/* ---------- START SCREEN ---------- */

#startScreen{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:black;
  z-index:10;
}

#beginBtn{
  background: url("stsbutton.png") no-repeat center/contain;
  border:none;
  width:320px;
  height:120px;
  font-family:'Press Start 2P';
  font-size:22px;
  color:#3a240f;
  cursor:pointer;
}

/* ---------- FRAME & WINDOW ---------- */

#frame{
  position:absolute;
  inset:0;
  background:url("stsframe2.png") no-repeat center/contain;
  opacity:0;
  transition: opacity 1s ease;
}

/* the viewport inside the frame */
#window{
  position:absolute;
  left:963.8801px;
  top:440.1124px;
  width:919.8045px;
  height:607.4107px;
  overflow:hidden;
  opacity:0;
  transition: opacity 1s ease;
}

/* island image */
#sceneImage{
  position:absolute;
  left:0;
  top:0;
  image-rendering: pixelated;
}

/* water overlay */
#waterOverlay{
  position:absolute;
  left:0;
  top:0;
  opacity:0.35;
  animation: waterMove 6s linear infinite;
  pointer-events:none;
  image-rendering: pixelated;
}

@keyframes waterMove{
  0%{ transform: translateX(0); }
  100%{ transform: translateX(-40px); }
}

/* ---------- LOGO ---------- */

#logo{
  position:absolute;
  inset:0;
  background:url("stslogo2.png") no-repeat center/contain;
  opacity:0;
  transition: opacity 1s ease;
  pointer-events:none;
}

/* ---------- TEXT BOX ---------- */

#dialogueWrap{
  position:absolute;
  left:965.8681px;
  top:862.4154px;
  width:813.4602px;
  height:83.053px;
  opacity:0;
  transition: opacity 0.5s ease;
}

#dialogue{
  font-size:20px;
  line-height:1.4;
  color:#3a240f;
  cursor:pointer;
}

/* ---------- CHOICE BUTTON ---------- */

#lookAroundWrap{
  position:absolute;
  left:50%;
  top:930px;
  transform:translateX(-50%);
  opacity:0;
  transition: opacity 0.6s ease;
}

#lookAroundBtn{
  background: url("stsbutton.png") no-repeat center/contain;
  border:none;
  width:360px;
  height:120px;
  font-family:'Press Start 2P';
  font-size:18px;
  color:#3a240f;
  cursor:pointer;
}

.visible{
  opacity:1 !important;
}
</style>
</head>

<body>

<div id="stage">

  <div id="startScreen">
    <button id="beginBtn" type="button">Begin</button>
  </div>

  <div id="window">
    <img id="sceneImage" src="island_base.png">
    <img id="waterOverlay" src="water_overlay.png">
  </div>

  <div id="frame"></div>
  <div id="logo"></div>

  <div id="dialogueWrap">
    <div id="dialogue"></div>
  </div>

  <div id="lookAroundWrap">
    <button id="lookAroundBtn" type="button">Look Around</button>
  </div>

  <audio id="music" src="starttheme.m4a" loop></audio>

</div>

<script>
const BASE_W = 1920;
const BASE_H = 1080;

function scaleStage(){
  const stage = document.getElementById("stage");
  const s = Math.min(window.innerWidth / BASE_W, window.innerHeight / BASE_H);
  stage.style.transform = "translate(-50%, -50%) scale(" + s + ")";
}

window.addEventListener("resize", scaleStage);

document.addEventListener("DOMContentLoaded", () => {
  scaleStage();

  const beginBtn = document.getElementById("beginBtn");
  const startScreen = document.getElementById("startScreen");
  const frame = document.getElementById("frame");
  const windowEl = document.getElementById("window");
  const logo = document.getElementById("logo");
  const dialogueWrap = document.getElementById("dialogueWrap");
  const dialogue = document.getElementById("dialogue");
  const lookAroundWrap = document.getElementById("lookAroundWrap");
  const lookAroundBtn = document.getElementById("lookAroundBtn");
  const music = document.getElementById("music");

  const text = "You wake up on a beach. Warm sand, slow waves, no memory of how you got here.";

  let typing = false;
  let idx = 0;
  let timer;

  function typeText(){
    typing = true;
    dialogue.textContent = "";
    idx = 0;

    function tick(){
      if(!typing) return;
      dialogue.textContent += text[idx++];
      if(idx < text.length){
        timer = setTimeout(tick, 35);
      } else {
        typing = false;
        lookAroundWrap.classList.add("visible");
      }
    }
    tick();
  }

  dialogue.addEventListener("click", () => {
    if(typing){
      clearTimeout(timer);
      typing = false;
      dialogue.textContent = text;
      lookAroundWrap.classList.add("visible");
    }
  });

  beginBtn.addEventListener("click", async () => {
    startScreen.style.display = "none";

    try{
      await music.play();
      music.volume = 0;
      let v = 0;
      const fade = setInterval(()=>{
        v += 0.02;
        music.volume = Math.min(v,1);
        if(v >= 1) clearInterval(fade);
      }, 60);
    }catch(e){}

    windowEl.classList.add("visible");
    frame.classList.add("visible");

    setTimeout(()=> logo.classList.add("visible"), 700);
    setTimeout(()=> logo.classList.remove("visible"), 3700);
    setTimeout(()=>{
      dialogueWrap.classList.add("visible");
      typeText();
    }, 4300);
  });

  lookAroundBtn.addEventListener("click", ()=>{
    window.location.href = "start2.html";
  });
});
</script>

</body>
</html>
