<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sea to Summit, Uphill 3</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Silkscreen:wght@400;700&display=swap" rel="stylesheet">

<style>
html, body {
  margin: 0;
  width: 100%;
  height: 100%;
  background: black;
  overflow: hidden;
  position: fixed;
  inset: 0;
}

* {
  overscroll-behavior: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
  -webkit-user-select: none;
}

body { touch-action: manipulation; }

.app {
  position: fixed;
  inset: 0;
  background: black;
  overflow: hidden;
}

/* Stage scaling */
.stage-wrapper {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) scale(1);
  transform-origin: center center;
  width: 1920px;
  height: 1080px;
}

.stage {
  position: relative;
  width: 1920px;
  height: 1080px;
}

.layer {
  position: absolute;
  inset: 0;
  width: 1920px;
  height: 1080px;
  image-rendering: pixelated;
  pointer-events: none;
}

.scene { z-index: 1; }
.frame { z-index: 10; }

/* Story box */
.story {
  position: absolute;
  left: 50%;
  bottom: 180px;
  transform: translateX(-50%);
  width: 900px;

  font-family: "Silkscreen";
  font-size: 30px;
  line-height: 1.25;
  color: black;

  opacity: 0;
  transition: opacity 500ms ease;
  z-index: 25;

  min-height: 96px;
  padding: 16px 50px 0 50px;
  box-sizing: border-box;
}
.story.visible { opacity: 1; }

/* Buttons */
.button {
  position: relative;
  display: inline-block;
  cursor: pointer;
}

.button img {
  width: 420px;
  image-rendering: pixelated;
  display: block;
  pointer-events: none;
}

.button span {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  font-family: "Press Start 2P";
  font-size: 26px;
  letter-spacing: -1px;
  color: black;
  pointer-events: none;
  padding: 0 20px;
  text-align: center;
  line-height: 1.05;
}

/* Continue button */
.continue-wrap {
  position: absolute;
  left: 50%;
  bottom: 5px;
  transform: translateX(-50%) scale(0.84);
  z-index: 40;
}
.continue-wrap.hidden {
  opacity: 0;
  pointer-events: none;
}

/* Choices */
.choices {
  position: absolute;
  left: 50%;
  bottom: 5px;
  transform: translateX(-50%);
  display: flex;
  gap: 40px;
  opacity: 0;
  transition: opacity 600ms ease;
  z-index: 30;
}
.choices.visible { opacity: 1; }

.choice-link {
  text-decoration: none;
  transform: scale(0.84);
  transform-origin: center center;
}
</style>
</head>

<body>
<div class="app">

  <div class="stage-wrapper" id="stageWrapper">
    <div class="stage">

      <img class="layer scene" src="uphill3i.png" alt="">
      <img class="layer frame" src="stsframe3.png" alt="">

      <div class="story visible" id="story"></div>

      <div class="continue-wrap" id="continueWrap">
        <div class="button" id="btnContinue">
          <img src="stsbutton.png" alt="">
          <span>Continue</span>
        </div>
      </div>

      <div class="choices" id="choices">
        <a class="choice-link" href="uphill2.html">
          <div class="button">
            <img src="stsbutton.png" alt="">
            <span>Back</span>
          </div>
        </a>

        <a class="choice-link" href="uphill4.html">
          <div class="button">
            <img src="stsbutton.png" alt="">
            <span>Take It Slow and Steady</span>
          </div>
        </a>

        <a class="choice-link" href="scramble1.html">
          <div class="button">
            <img src="stsbutton.png" alt="">
            <span>Scramble Up the Rocks</span>
          </div>
        </a>
      </div>

    </div>
  </div>

</div>

<script>
/* Scale stage */
const stageWrapper = document.getElementById("stageWrapper");
function scaleStage() {
  const scale = Math.min(window.innerWidth / 1920, window.innerHeight / 1080);
  stageWrapper.style.transform = "translate(-50%, -50%) scale(" + scale + ")";
}
window.addEventListener("resize", scaleStage);
window.addEventListener("pageshow", () => setTimeout(scaleStage, 60));
scaleStage();

/* Story logic */
const story = document.getElementById("story");
const continueWrap = document.getElementById("continueWrap");
const choices = document.getElementById("choices");
const btnContinue = document.getElementById("btnContinue");

const lines = [
  "The ridge levels out just enough for you to pause.",
  "Ahead, the trail splits into two ways up the next rise.",
  "One path climbs gently but is loose underfoot.",
  "The other cuts sharply to the right over angled rock.",
  "Both lead upward, they just ask different things of you."
];

let line = 0;
let char = 0;
let typing = null;

function showChoices() {
  continueWrap.classList.add("hidden");
  choices.classList.add("visible");
}

function typeLine() {
  clearInterval(typing);
  story.textContent = "";
  char = 0;

  typing = setInterval(() => {
    char++;
    story.textContent = lines[line].slice(0, char);
    if (char >= lines[line].length) {
      clearInterval(typing);
      if (line === lines.length - 1) showChoices();
    }
  }, 24);
}

function advanceStory() {
  if (char < lines[line].length) {
    story.textContent = lines[line];
    clearInterval(typing);
    if (line === lines.length - 1) showChoices();
    return;
  }
  if (line < lines.length - 1) {
    line++;
    typeLine();
  }
}

btnContinue.addEventListener("pointerup", e => {
  e.preventDefault();
  e.stopPropagation();
  advanceStory();
});

/* Start */
typeLine();
</script>
</body>
</html>
